weights = ~ n_flu,
cluster = ~ state
)
m23_tdap <- feols(
vacc_tdap_pct ~ unins_z * nchs13_z | state + year,
data    = dat_tdap,
weights = ~ n_tdap,
cluster = ~ state
)
fixest::etable(
m23_flu, m23_tdap,
se   = "cluster",
dict = c(unins_z = "Uninsurance (z)",
nchs13_z = "NCHS 2013 (z)",
"unins_z:nchs13_z" = "Unins Ã— NCHS13"),
title = "Aim 2.3 â€” TWFE with interaction (state & year FE; clustered SE by state)"
)
me_table <- function(mod, dat0, title){
b  <- coef(mod)
V  <- vcov(mod)
b1 <- b["unins_z"]
b3 <- b["unins_z:nchs13_z"]
V11 <- V["unins_z","unins_z"]
V33 <- V["unins_z:nchs13_z","unins_z:nchs13_z"]
V13 <- V["unins_z","unins_z:nchs13_z"]
nchs_seq <- 1:6
mu  <- mean(dat0$nchs_2013, na.rm=TRUE)
sdv <- sd(dat0$nchs_2013,   na.rm=TRUE)
z   <- (nchs_seq - mu)/sdv
tibble(
NCHS = nchs_seq,
nchs13_z = z,
marginal_effect = b1 + b3 * z,
se = sqrt(V11 + (z^2)*V33 + 2*z*V13),
lo95 = marginal_effect - 1.96*se,
hi95 = marginal_effect + 1.96*se,
model = title
)
}
me_flu  <- me_table(m23_flu,  dat_flu,  "Flu")
me_tdap <- me_table(m23_tdap, dat_tdap, "Tdap")
me_all  <- dplyr::bind_rows(me_flu, me_tdap)
ggplot(me_all, aes(x = NCHS, y = marginal_effect, color = model)) +
geom_line() + geom_point() +
geom_ribbon(aes(ymin = lo95, ymax = hi95, fill = model), alpha = .15, color = NA) +
labs(x = "NCHS (1 = urban â†’ 6 = rural)",
y = "Marginal effect of Uninsurance on coverage (pp per 1 SD)",
title = "Aim 2.3 â€” Interaction: Uninsurance Ã— NCHS (marginal effects)") +
theme_minimal()
# helper
num_any  <- function(x) if (is.numeric(x)) as.numeric(x) else readr::parse_number(as.character(x))
norm_names <- function(df){
nm <- names(df)
nm <- gsub("[^A-Za-z0-9]+","_", nm); nm <- gsub("_+","_", nm); nm <- tolower(nm)
names(df) <- nm; df
}
pick <- function(nm, cands){
cand <- intersect(tolower(cands), nm);if (length(cand)) cand[1]
else NA_character_ }
# Rebuild nchs_lookup from original NCHS CSV
nchs_raw <- readr::read_csv("state_urban_index_2013_2023.csv",
show_col_types = FALSE) |> norm_names()
cand_state <- c("st_abbrev","state","state_abbrev","state_abbreviation","st")
cand_2013  <- c("index2013","index_2013","nchs2013","nchs_2013","score2013")
cand_2023  <- c("index2023","index_2023","nchs2023","nchs_2023","score2023")
scol <- pick(names(nchs_raw), cand_state)
c13  <- pick(names(nchs_raw), cand_2013)
c23  <- pick(names(nchs_raw), cand_2023)
# If it stops here, it means that the column name in the file is not among the candidates, and the real column name needs to be added to cand_*.
stopifnot(!is.na(scol), !is.na(c13), !is.na(c23))
nchs_lookup <- nchs_raw |>
dplyr::transmute(
state      = toupper(.data[[scol]]),
nchs_2013  = num_any(.data[[c13]]),
nchs_2023  = num_any(.data[[c23]])
) |>
dplyr::mutate(nchs_base = dplyr::coalesce(nchs_2013, nchs_2023))
# Use it to make a special panel for 6A drawing (no year intersection)
panel_plot <- vacc_wide %>%
dplyr::inner_join(ins,  by = c("state","year")) %>%
dplyr::left_join(nchs_lookup %>%
dplyr::select(state, nchs_2013, nchs_2023, nchs_base), by = "state") %>%
dplyr::mutate(
vacc_flu_pct  = as.numeric(vacc_flu_pct),
vacc_tdap_pct = as.numeric(vacc_tdap_pct),
n_flu         = as.numeric(n_flu),
n_tdap        = as.numeric(n_tdap)
)
# plot
lab_nchs <- function(x) factor(x, levels = 1:6, labels = paste0("NCHS ", 1:6))
panel_plot_grp <- panel_plot %>%
dplyr::mutate(
# Map continuous indices to 1..6, and truncate out-of-bounds indices to [1,6]
nchs_grp = dplyr::case_when(
is.na(nchs_base) ~ NA_integer_,
TRUE ~ pmin(6L, pmax(1L, as.integer(round(nchs_base))))
),
nchs_lab = lab_nchs(nchs_grp)
)
flu_plot_df <- panel_plot_grp %>%
dplyr::filter(!is.na(vacc_flu_pct),
!is.na(uninsured_rate),
!is.na(nchs_grp))
ggplot(flu_plot_df, aes(uninsured_rate, vacc_flu_pct, color = nchs_lab)) +
geom_point(aes(size = n_flu), alpha = .35) +
geom_smooth(method = "lm", se = FALSE) +
scale_size_continuous(name = "Sample size") +
scale_color_discrete(name = "Rurality") +
labs(x = "Uninsurance rate", y = "Flu coverage (%)",
title = "Observed scatter with OLS fits by NCHS (Flu)") +
theme_minimal()
tdap_plot_df <- panel_plot_grp %>%
dplyr::filter(!is.na(vacc_tdap_pct),
!is.na(uninsured_rate),
!is.na(nchs_grp))
ggplot(tdap_plot_df, aes(uninsured_rate, vacc_tdap_pct, color = nchs_lab)) +
# If n_tdap is missing, the default size will be given..
geom_point(aes(size = tidyr::replace_na(n_tdap, 1000)), alpha = .35) +
geom_smooth(method = "lm", se = FALSE) +
scale_size_continuous(name = "Sample size") +
scale_color_discrete(name = "Rurality") +
labs(x = "Uninsurance rate", y = "Tdap coverage (%)",
title = "Observed scatter with OLS fits by NCHS (Tdap)") +
theme_minimal()
# Generate prediction grid
mk_grid <- function(dat){
g <- expand.grid(
nchs_2013 = 1:6,
uninsured_rate = seq(min(dat$uninsured_rate, na.rm=TRUE),
max(dat$uninsured_rate, na.rm=TRUE), length.out = 50),
year  = median(dat$year, na.rm=TRUE),
state = dat$state[1]
)
g <- dplyr::mutate(
g,
nchs13_z = (nchs_2013 - mean(dat$nchs_2013, na.rm=TRUE))/sd(dat$nchs_2013, na.rm=TRUE),
unins_z  = (uninsured_rate - mean(dat$uninsured_rate,
na.rm=TRUE))/sd(dat$uninsured_rate, na.rm=TRUE)
)
g
}
grid_flu  <- mk_grid(dat_flu)
grid_flu$pred  <- predict(m23_flu,  newdata = grid_flu)
grid_tdap <- mk_grid(dat_tdap)
grid_tdap$pred <- predict(m23_tdap, newdata = grid_tdap)
# Faceted prediction line
ggplot(grid_flu, aes(uninsured_rate, pred)) +
geom_line() +
facet_wrap(~ nchs_2013, nrow = 2, labeller = label_both) +
labs(x="Uninsurance rate", y="Predicted Flu coverage (%)",
title="TWFE predicted lines by NCHS (Flu)") +
theme_minimal()
ggplot(grid_tdap, aes(uninsured_rate, pred)) +
geom_line() +
facet_wrap(~ nchs_2013, nrow = 2, labeller = label_both) +
labs(x="Uninsurance rate", y="Predicted Tdap coverage (%)",
title="TWFE predicted lines by NCHS (Tdap)") +
theme_minimal()
# Predict grid function
mk_heat <- function(dat, mod){
g <- expand.grid(
nchs_2013 = 1:6,
uninsured_rate = seq(min(dat$uninsured_rate, na.rm=TRUE),
max(dat$uninsured_rate, na.rm=TRUE), length.out = 80),
year  = median(dat$year, na.rm=TRUE),
state = dat$state[1]
)
g <- dplyr::mutate(
g,
nchs13_z = (nchs_2013 - mean(dat$nchs_2013, na.rm=TRUE))/sd(dat$nchs_2013, na.rm=TRUE),
unins_z  = (uninsured_rate - mean(dat$uninsured_rate,
na.rm=TRUE))/sd(dat$uninsured_rate, na.rm=TRUE)
)
g$pred <- predict(mod, newdata = g)
g
}
heat_flu  <- mk_heat(dat_flu,  m23_flu)
heat_tdap <- mk_heat(dat_tdap, m23_tdap)
# Discretize the continuous uninsurance into "grid strips" and take
# the average predicted value for each grid
# we can increase or decrease nbins to control the number of grids
nbins <- 12
bin_and_avg <- function(g){
rng <- range(g$uninsured_rate, na.rm = TRUE)
breaks <- seq(rng[1], rng[2], length.out = nbins + 1)
g %>%
dplyr::mutate(
nchs_bin  = factor(nchs_2013, levels = 1:6, labels = paste0("NCHS ", 1:6)),
unins_bin = cut(uninsured_rate, breaks = breaks, include.lowest = TRUE)
) %>%
dplyr::group_by(nchs_bin, unins_bin) %>%
dplyr::summarise(pred = mean(pred, na.rm = TRUE), .groups = "drop")
}
heat_flu_b  <- bin_and_avg(heat_flu)
heat_tdap_b <- bin_and_avg(heat_tdap)
# heatmap
ggplot(heat_flu_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +  # Add white grid lines
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Flu coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()
ggplot(heat_tdap_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Tdap coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()
ggplot(heat_flu_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +  # Add white grid lines
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Flu coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x  = element_text(size = 8),   # è°ƒæ•´xè½´åˆ»åº¦æ–‡å­—å¤§å°
axis.title.x = element_text(size = 10)   # ï¼ˆå¯é€‰ï¼‰xè½´æ ‡é¢˜å¤§å°
)
ggplot(heat_flu_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +  # Add white grid lines
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Flu coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x  = element_text(size = 7),   # è°ƒæ•´xè½´åˆ»åº¦æ–‡å­—å¤§å°
)
ggplot(heat_flu_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +  # Add white grid lines
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Flu coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x = element_text(size = 8, angle = 45, hjust = 1, vjust = 1)
)
ggplot(heat_tdap_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Tdap coverage â€” binned heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x = element_text(size = 8, angle = 45, hjust = 1, vjust = 1)
)
ggplot(heat_flu_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +  # Add white grid lines
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Flu coverage heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x = element_text(size = 8, angle = 45, hjust = 1, vjust = 1)
)
ggplot(heat_tdap_b, aes(x = nchs_bin, y = unins_bin, fill = pred)) +
geom_tile(color = "white", size = 0.6) +
scale_fill_gradient(low = "#f7fbff", high = "#08306b",
name = "Predicted coverage (%)") +
labs(x="NCHS (1=urban â†’ 6=rural)", y="Uninsurance (binned)",
title="Predicted Tdap coverage heatmap") +
coord_equal() +
scale_fill_viridis_c(option = "magma", direction = -1, name = "Predicted (%)") +
theme_minimal()+
theme(
axis.text.x = element_text(size = 8, angle = 45, hjust = 1, vjust = 1)
)
ggplot(me_all, aes(x = NCHS, y = marginal_effect, color = model)) +
geom_point(position = position_dodge(width=.2), size = 2) +
geom_errorbar(aes(ymin = lo95, ymax = hi95), width = .15,
position = position_dodge(width=.2)) +
geom_hline(yintercept = 0, linetype = "dashed") +
labs(x = "NCHS (1=urban â†’ 6=rural)",
y = "Marginal effect of Uninsurance (pp per 1 SD)",
title = "Aim 2.3 â€” Marginal effects with 95% CI") +
theme_minimal()
coef_plot <- function(mod, title){
broom::tidy(mod, conf.int = TRUE) |>
filter(term %in% c("unins_z","unins_z:nchs13_z")) |>
mutate(term = recode(term,
"unins_z" = "Uninsurance (z)",
"unins_z:nchs13_z" = "Unins Ã— NCHS13")) |>
ggplot(aes(estimate, term)) +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = .15) +
geom_vline(xintercept = 0, linetype = "dashed") +
labs(x = "Coefficient (pp)", y = NULL, title = title) +
theme_minimal()
}
coef_plot(m23_flu,  "TWFE coefficients (Flu)")
coef_plot(m23_tdap, "TWFE coefficients (Tdap)")
coef_plot <- function(mod, title){
broom::tidy(mod, conf.int = TRUE) |>
filter(term %in% c("unins_z","unins_z:nchs13_z")) |>
mutate(term = recode(term,
"unins_z" = "Uninsurance (z)",
"unins_z:nchs13_z" = "Unins Ã— NCHS13")) |>
ggplot(aes(estimate, term)) +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = .15) +
geom_vline(xintercept = 0, linetype = "dashed") +
labs(x = "Coefficient (pp)", y = NULL, title = title) +
theme_minimal()
}
coef_plot(m23_flu,  "TWFE coefficients (Flu)")
coef_plot(m23_tdap, "TWFE coefficients (Tdap)")
# Replace NCHS with 2023 index in interaction
m23_flu_2023 <- feols(vacc_flu_pct  ~ unins_z * scale(nchs_2023)[,1] | state + year,
data = dat_flu, weights = ~ n_flu, cluster = ~ state)
m23_tdap_2023 <- feols(vacc_tdap_pct ~ unins_z * scale(nchs_2023)[,1] | state + year,
data = dat_tdap, weights = ~ n_tdap, cluster = ~ state)
fixest::etable(m23_flu_2023, m23_tdap_2023, se="cluster", title="Replace NCHS with 2023 index")
# Unweighted versions
m23_flu_unw  <- feols(vacc_flu_pct  ~ unins_z * nchs13_z |
state + year, data = dat_flu,  cluster = ~ state)
m23_tdap_unw <- feols(vacc_tdap_pct ~ unins_z * nchs13_z |
state + year, data = dat_tdap, cluster = ~ state)
fixest::etable(m23_flu_unw, m23_tdap_unw, se="cluster", title="Unweighted models")
setwd("/Users/ruiqili/Desktop/R")
residents <- read.csv("Residents.csv")
treats <- read.csv("Treats.csv")
hourly <- read.csv("Hourly_Locations.csv")
sightings <- read.delim("zombie_sightings.txt", sep=",", header=FALSE)
##############################################################
# ğŸƒ The Coding Dead Challenge: Zombie Outbreak Data Analysis
# Author: Ruiqi Li
# Date: 2025-10-30
##############################################################
# --- 1. Load Packages ---
library(tidyverse)
library(lubridate)
library(ggplot2)
# --- 2. Read the Data ---
residents <- read_csv("Residents.csv")
treats <- read_csv("Treats.csv")
locations <- read_csv("Hourly_Locations.csv")
sightings <- read_delim("zombie_sightings.txt", delim = ",", col_names = FALSE)
# Clean column names
colnames(sightings) <- c("Name", "Costume", "Behavior", "Location", "Hour")
sightings <- sightings %>%
mutate(
Hour = parse_number(Hour),
Name = str_trim(Name),
Costume = str_trim(Costume),
Location = str_trim(Location)
)
sightings_raw <- read_lines("zombie_sightings.txt")
# ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£ææ¯è¡Œï¼šæå–åå­—ã€è£…æ‰®ã€åœ°ç‚¹ã€æ—¶é—´
sightings <- tibble(raw = sightings_raw) %>%
mutate(
Name = str_extract(raw, "^[^,]+, [^,]+"),  # ä¾‹å¦‚ "Beaman, Morgan"
Costume = str_extract(raw, "dressed as a ([A-Za-z]+)"),
Costume = str_remove(Costume, "dressed as a "),
Location = str_extract(raw, "at (\\w+) around"),
Location = str_remove(Location, "at "),
Hour = str_extract(raw, "(\\d{1,2}) o'clock"),
Hour = as.numeric(str_extract(Hour, "\\d+"))
) %>%
select(Name, Costume, Location, Hour)
# æ£€æŸ¥è§£æåçš„å‰å‡ è¡Œ
head(sightings)
# Clean column names
colnames(sightings) <- c("Name", "Costume", "Behavior", "Location", "Hour")
sightings <- sightings %>%
mutate(
Hour = parse_number(Hour),
Name = str_trim(Name),
Costume = str_trim(Costume),
Location = str_trim(Location)
)
sightings <- sightings %>%
mutate(
Hour = parse_number("Hour"),
Name = str_trim("Name"),
Costume = str_trim("Costume"),
Location = str_trim("Location")
)
# ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£ææ¯è¡Œï¼šæå–åå­—ã€è£…æ‰®ã€åœ°ç‚¹ã€æ—¶é—´
sightings <- tibble(raw = sightings_raw) %>%
mutate(
Name = str_extract(raw, "^[^,]+, [^,]+"),  # "Beaman, Morgan"
Costume = str_extract(raw, "dressed as a ([A-Za-z]+)"),
Costume = str_remove(Costume, "dressed as a "),
Location = str_extract(raw, "at ([A-Za-z]+) around"),
Location = str_remove(Location, "at "),
Hour = str_extract(raw, "(\\d{1,2}) o'clock"),
Hour = as.numeric(str_extract(Hour, "\\d+"))
) %>%
select(Name, Costume, Location, Hour)
# æ£€æŸ¥è§£æåçš„å‰å‡ è¡Œ
head(sightings)
# Clean column names
colnames(sightings) <- c("Name", "Costume", "Behavior", "Location", "Hour")
sightings <- sightings %>%
mutate(
Hour = parse_number(Hour),
Name = str_trim(Name),
Costume = str_trim(Costume),
Location = str_trim(Location)
)
# --- 3. Identify the Origin of the Pandemic ---
# Find earliest zombie sightings
origin <- sightings %>%
arrange(Hour) %>%
slice(1:10)  # show first few cases
getwd()
setwd("/Users/ruiqili/Desktop/Data_Wrangling_Final_Project_Fall2025/Aim2.2&2.3/analysis report")
# ---- install (if needed) ----
install.packages(c("officer","magrittr","flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
install.packages(c("officer", "magrittr", "flextable"))
# ---- install (if needed) ----
install.packages("officer", repos = "https://cloud.r-project.org", dependencies = TRUE)
install.packages("magrittr", repos = "https://cloud.r-project.org", dependencies = TRUE)
install.packages("magrittr", repos = "https://cloud.r-project.org", dependencies = TRUE)
install.packages("magrittr", repos = "https://cloud.r-project.org", dependencies = TRUE)
install.packages("flextable", repos = "https://cloud.r-project.org", dependencies = TRUE)
install.packages("magrittr", repos = "https://cloud.r-project.org", dependencies = TRUE)
library(officer)
library(magrittr)
library(flextable)
# ---- helper: add bullets quickly (ç”¨â€œâ€¢ â€å­—ç¬¦åšè§†è§‰é¡¹ç›®ç¬¦å·ï¼Œå…¼å®¹ Google Slides) ----
add_bullets <- function(x, bullets, title = NULL){
if (!is.null(title)) x <- ph_with(x, title, location = ph_location_type(type = "title"))
loc <- ph_location_type(type = "body")
# æ¸…ç©ºå ä½
x <- ph_empty(x, location = loc)
for (i in seq_along(bullets)) {
line <- paste0("\u2022  ", bullets[[i]])
x <- ph_with(x, fpar(ftext(line, fp_text(font.size = 20))),
location = loc)
}
x
}
# ---- helper: center image if exists; otherwiseå†™â€œç¼ºå›¾å ä½â€ ----
add_image_centered <- function(x, path, title, width = 9, height = NULL){
x <- ph_with(x, title, location = ph_location_type(type = "title"))
if (file.exists(path)) {
x <- ph_with(x, external_img(path, width = width, height = height),
location = ph_location(type = "body",
left = (10 - width)/2, top = 1.1))
} else {
msg <- sprintf("[Image missing: %s]", basename(path))
x <- ph_with(x, fpar(ftext(msg, fp_text(color = "#B00000", font.size = 18))),
location = ph_location_type(type = "body"))
}
x
}
# ---- start deck ----
ppt <- read_pptx()
# 1) Title
ppt <- add_slide(ppt, layout = "Title Slide") |>
ph_with("Aim 2.2 & 2.3 â€” Urbanicity, Uninsurance, and Maternal Vaccination",
location = ph_location_type(type = "ctrTitle")) |>
ph_with("Ruiqi Li â€¢ Dartmouth Health Data Science\nInfluenza & Tdap | Stateâ€“Year Panel",
location = ph_location_type(type = "subTitle"))
# 2) Objectives
ppt <- add_slide(ppt, layout = "Title and Content")
ppt <- add_bullets(ppt, title = "Objectives & Questions", bullets = c(
"Aim 2.2: Between-state association â€” Does urbanicity (NCHS) relate to average coverage?",
"Aim 2.3: Within-state association â€” How do changes in uninsurance relate to coverage over time?",
"Moderation: Does the Uninsurance effect vary by NCHS level?"
))
# 3) Data & assembly
ppt <- add_slide(ppt, layout = "Title and Content")
ppt <- add_bullets(ppt, title = "Data sources & panel assembly", bullets = c(
"Vaccination among pregnant people (stateâ€“year): Flu %, Tdap %; weights n_flu / n_tdap.",
"Uninsurance (stateâ€“year): uninsured / (insured + uninsured).",
"Urbanicity: time-invariant baseline NCHS â€” 2013 if available, else 2023.",
"One row per stateâ€“yearâ€“vaccine (weighted mean if duplicates)."
))
# 4) Missing-data handling
ppt <- add_slide(ppt, layout = "Title and Content")
ppt <- add_bullets(ppt, title = "Missing-data handling", bullets = c(
"No imputation; complete-case per analysis.",
"NCHS baseline = coalesce(NCHS-2013, NCHS-2023); restrict to 1â€“6.",
"Vaccination: stateâ€“years without reported estimates remain missing.",
"Weights = sample sizes; SEs clustered by state."
))
# ---- install (if needed) ----
uninstall.packages("officer", repos = "https://cloud.r-project.org", dependencies = TRUE)
# ---- install (if needed) ----
remove.packages("officer", repos = "https://cloud.r-project.org", dependencies = TRUE)
# ---- install (if needed) ----
remove.packages("officer")
remove.packages("magrittr")
remove.packages("flextable")
